{"ast":null,"code":"var _jsxFileName = \"/Users/akshita/Downloads/vverse/videoflipper/src/RecordedPreview.jsx\",\n  _s = $RefreshSig$();\nimport { useEffect, useRef, useState } from 'react';\nimport './VideoFlipper.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RecordedPreview = ({\n  recordedData,\n  videoSrc\n}) => {\n  _s();\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const videoRef = useRef(null);\n  const fullVideoCanvasRef = useRef(null);\n  const cropperOverlayRef = useRef(null);\n  const animationRef = useRef(null);\n  useEffect(() => {\n    if (recordedData.length === 0) return;\n    const playback = () => {\n      if (!isPlaying) return;\n      const currentTime = videoRef.current.currentTime;\n      const currentData = recordedData[currentIndex];\n      const nextData = recordedData[currentIndex + 1];\n      if (nextData && currentTime >= nextData.timeStamp) {\n        setCurrentIndex(currentIndex + 1);\n      }\n      applyVideoAttributes(currentData);\n      drawVideoFrame();\n      animationRef.current = requestAnimationFrame(playback);\n    };\n    const applyVideoAttributes = data => {\n      if (!data) return;\n      videoRef.current.volume = data.volume;\n      videoRef.current.playbackRate = data.playbackRate;\n      const [x, y, width, height] = data.coordinates;\n      const cropperOverlay = cropperOverlayRef.current;\n      console.log('videoRef.current.getBoundingClientRect().height', videoRef.current.getBoundingClientRect().height, videoRef.current.getBoundingClientRect().width);\n      cropperOverlay.style.left = `${x / videoRef.current.getBoundingClientRect().width * 100}%`;\n      cropperOverlay.style.top = `${y / videoRef.current.getBoundingClientRect().height * 100}%`;\n      cropperOverlay.style.width = `${width / videoRef.current.getBoundingClientRect().width * 100}%`;\n      cropperOverlay.style.height = `${height / videoRef.current.getBoundingClientRect().height * 100}%`;\n    };\n    const drawVideoFrame = () => {\n      const fullVideoCanvas = fullVideoCanvasRef.current;\n      const fullVideoCtx = fullVideoCanvas.getContext('2d');\n      fullVideoCanvas.width = videoRef.current.videoWidth;\n      fullVideoCanvas.height = videoRef.current.videoHeight;\n      fullVideoCtx.drawImage(videoRef.current, 0, 0);\n    };\n    if (isPlaying) {\n      videoRef.current.play();\n      animationRef.current = requestAnimationFrame(playback);\n    } else {\n      videoRef.current.pause();\n      cancelAnimationFrame(animationRef.current);\n    }\n    return () => cancelAnimationFrame(animationRef.current);\n  }, [recordedData, currentIndex, isPlaying]);\n  const togglePlayback = () => {\n    setIsPlaying(!isPlaying);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"mt-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-2 flex justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cropper-bottom-btn\",\n        onClick: togglePlayback,\n        children: isPlaying ? \"Pause\" : \"Play\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"video-container\",\n        children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n          className: \"video\",\n          ref: fullVideoCanvasRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          id: \"draggable\",\n          ref: cropperOverlayRef,\n          className: \"cropper\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 83,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      src: videoSrc,\n      style: {\n        visibility: \"hidden\"\n      },\n      className: \"video-container-hidden\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 73,\n    columnNumber: 5\n  }, this);\n};\n_s(RecordedPreview, \"nBj+UjCw6P1jomm8HNrQ42UhgFI=\");\n_c = RecordedPreview;\nexport default RecordedPreview;\nvar _c;\n$RefreshReg$(_c, \"RecordedPreview\");","map":{"version":3,"names":["useEffect","useRef","useState","jsxDEV","_jsxDEV","RecordedPreview","recordedData","videoSrc","_s","currentIndex","setCurrentIndex","isPlaying","setIsPlaying","videoRef","fullVideoCanvasRef","cropperOverlayRef","animationRef","length","playback","currentTime","current","currentData","nextData","timeStamp","applyVideoAttributes","drawVideoFrame","requestAnimationFrame","data","volume","playbackRate","x","y","width","height","coordinates","cropperOverlay","console","log","getBoundingClientRect","style","left","top","fullVideoCanvas","fullVideoCtx","getContext","videoWidth","videoHeight","drawImage","play","pause","cancelAnimationFrame","togglePlayback","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","ref","id","src","visibility","_c","$RefreshReg$"],"sources":["/Users/akshita/Downloads/vverse/videoflipper/src/RecordedPreview.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport './VideoFlipper.css';\n\nconst RecordedPreview = ({ recordedData, videoSrc }) => {\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const videoRef = useRef(null);\n  const fullVideoCanvasRef = useRef(null);\n  const cropperOverlayRef = useRef(null);\n  const animationRef = useRef(null);\n\n  useEffect(() => {\n    if (recordedData.length === 0) return;\n\n    const playback = () => {\n      if (!isPlaying) return;\n\n      const currentTime = videoRef.current.currentTime;\n      const currentData = recordedData[currentIndex];\n      const nextData = recordedData[currentIndex + 1];\n\n      if (nextData && currentTime >= nextData.timeStamp) {\n        setCurrentIndex(currentIndex + 1);\n      }\n\n      applyVideoAttributes(currentData);\n      drawVideoFrame();\n\n      animationRef.current = requestAnimationFrame(playback);\n    };\n\n    const applyVideoAttributes = (data) => {\n      if (!data) return;\n\n      videoRef.current.volume = data.volume;\n      videoRef.current.playbackRate = data.playbackRate;\n\n      const [x, y, width, height] = data.coordinates;\n      const cropperOverlay = cropperOverlayRef.current;\n      console.log('videoRef.current.getBoundingClientRect().height', videoRef.current.getBoundingClientRect().height, videoRef.current.getBoundingClientRect().width)\n      cropperOverlay.style.left = `${(x / videoRef.current.getBoundingClientRect().width) * 100}%`;\n      cropperOverlay.style.top = `${(y / videoRef.current.getBoundingClientRect().height) * 100}%`;\n      cropperOverlay.style.width = `${(width / videoRef.current.getBoundingClientRect().width) * 100}%`;\n      cropperOverlay.style.height = `${(height / videoRef.current.getBoundingClientRect().height) * 100}%`;\n    };\n\n    const drawVideoFrame = () => {\n      const fullVideoCanvas = fullVideoCanvasRef.current;\n      const fullVideoCtx = fullVideoCanvas.getContext('2d');\n\n      fullVideoCanvas.width = videoRef.current.videoWidth;\n      fullVideoCanvas.height = videoRef.current.videoHeight;\n\n      fullVideoCtx.drawImage(videoRef.current, 0, 0);\n    };\n\n    if (isPlaying) {\n      videoRef.current.play();\n      animationRef.current = requestAnimationFrame(playback);\n    } else {\n      videoRef.current.pause();\n      cancelAnimationFrame(animationRef.current);\n    }\n\n    return () => cancelAnimationFrame(animationRef.current);\n  }, [recordedData, currentIndex, isPlaying]);\n\n  const togglePlayback = () => {\n    setIsPlaying(!isPlaying);\n  };\n\n  return (\n    <div className=\"mt-4\">\n      <div className=\"mt-2 flex justify-center\">\n        <div className='cropper-bottom-btn' onClick={togglePlayback}>{isPlaying ? \"Pause\" : \"Play\"}</div>\n      </div>\n      <div className=\"flex\">\n        <div className=\"video-container\">\n          <canvas\n            className=\"video\"\n            ref={fullVideoCanvasRef}\n          />\n          <div\n            id=\"draggable\"\n            ref={cropperOverlayRef}\n            className=\"cropper\"\n          />\n        </div>\n        {/* <div className=\"video-container\">\n          Cropped\n          <canvas ref={croppedCanvasRef} className=\"w-full\" />\n        </div> */}\n      </div>\n      <video ref={videoRef} src={videoSrc} style={{ visibility: \"hidden\" }} className=\"video-container-hidden\" />\n    </div>\n  );\n};\n\nexport default RecordedPreview;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import{useEffect,useRef,useState}from'react';import'./VideoFlipper.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const RecordedPreview=_ref=>{let{recordedData,videoSrc}=_ref;const[currentIndex,setCurrentIndex]=useState(0);const[isPlaying,setIsPlaying]=useState(false);const videoRef=useRef(null);const fullVideoCanvasRef=useRef(null);const cropperOverlayRef=useRef(null);const animationRef=useRef(null);useEffect(()=>{if(recordedData.length===0)return;const playback=()=>{if(!isPlaying)return;const currentTime=videoRef.current.currentTime;const currentData=recordedData[currentIndex];const nextData=recordedData[currentIndex+1];if(nextData&&currentTime>=nextData.timeStamp){setCurrentIndex(currentIndex+1);}applyVideoAttributes(currentData);drawVideoFrame();animationRef.current=requestAnimationFrame(playback);};const applyVideoAttributes=data=>{if(!data)return;videoRef.current.volume=data.volume;videoRef.current.playbackRate=data.playbackRate;const[x,y,width,height]=data.coordinates;const cropperOverlay=cropperOverlayRef.current;console.log('videoRef.current.getBoundingClientRect().height',videoRef.current.getBoundingClientRect().height,videoRef.current.getBoundingClientRect().width);cropperOverlay.style.left=`${x/videoRef.current.getBoundingClientRect().width*100}%`;cropperOverlay.style.top=`${y/videoRef.current.getBoundingClientRect().height*100}%`;cropperOverlay.style.width=`${width/videoRef.current.getBoundingClientRect().width*100}%`;cropperOverlay.style.height=`${height/videoRef.current.getBoundingClientRect().height*100}%`;};const drawVideoFrame=()=>{const fullVideoCanvas=fullVideoCanvasRef.current;const fullVideoCtx=fullVideoCanvas.getContext('2d');fullVideoCanvas.width=videoRef.current.videoWidth;fullVideoCanvas.height=videoRef.current.videoHeight;fullVideoCtx.drawImage(videoRef.current,0,0);};if(isPlaying){videoRef.current.play();animationRef.current=requestAnimationFrame(playback);}else{videoRef.current.pause();cancelAnimationFrame(animationRef.current);}return()=>cancelAnimationFrame(animationRef.current);},[recordedData,currentIndex,isPlaying]);const togglePlayback=()=>{setIsPlaying(!isPlaying);};return/*#__PURE__*/_jsxs(\"div\",{className:\"recorded-preview\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"cropper-bottom-btn\",onClick:togglePlayback,children:isPlaying?\"Pause Recording\":\"Play Recording\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"video-container\",children:[/*#__PURE__*/_jsx(\"canvas\",{className:\"video\",ref:fullVideoCanvasRef}),/*#__PURE__*/_jsxs(\"div\",{id:\"draggable\",ref:cropperOverlayRef,className:\"cropper\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"grid-item\"}),/*#__PURE__*/_jsx(\"div\",{class:\"grid-item\"}),/*#__PURE__*/_jsx(\"div\",{class:\"grid-item\"}),/*#__PURE__*/_jsx(\"div\",{class:\"grid-item\"}),/*#__PURE__*/_jsx(\"div\",{class:\"grid-item\"}),/*#__PURE__*/_jsx(\"div\",{class:\"grid-item\"}),/*#__PURE__*/_jsx(\"div\",{class:\"grid-item\"}),/*#__PURE__*/_jsx(\"div\",{class:\"grid-item\"}),/*#__PURE__*/_jsx(\"div\",{class:\"grid-item\"})]})]}),/*#__PURE__*/_jsx(\"video\",{ref:videoRef,src:videoSrc,style:{visibility:\"hidden\"},className:\"video-container-hidden\"})]});};export default RecordedPreview;","map":{"version":3,"names":["useEffect","useRef","useState","jsx","_jsx","jsxs","_jsxs","RecordedPreview","_ref","recordedData","videoSrc","currentIndex","setCurrentIndex","isPlaying","setIsPlaying","videoRef","fullVideoCanvasRef","cropperOverlayRef","animationRef","length","playback","currentTime","current","currentData","nextData","timeStamp","applyVideoAttributes","drawVideoFrame","requestAnimationFrame","data","volume","playbackRate","x","y","width","height","coordinates","cropperOverlay","console","log","getBoundingClientRect","style","left","top","fullVideoCanvas","fullVideoCtx","getContext","videoWidth","videoHeight","drawImage","play","pause","cancelAnimationFrame","togglePlayback","className","children","onClick","ref","id","class","src","visibility"],"sources":["/Users/akshita/Downloads/akshitabansal97.github.io/src/RecordedPreview.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport './VideoFlipper.css';\n\nconst RecordedPreview = ({ recordedData, videoSrc }) => {\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [isPlaying, setIsPlaying] = useState(false);\n  const videoRef = useRef(null);\n  const fullVideoCanvasRef = useRef(null);\n  const cropperOverlayRef = useRef(null);\n  const animationRef = useRef(null);\n\n  useEffect(() => {\n    if (recordedData.length === 0) return;\n\n    const playback = () => {\n      if (!isPlaying) return;\n\n      const currentTime = videoRef.current.currentTime;\n      const currentData = recordedData[currentIndex];\n      const nextData = recordedData[currentIndex + 1];\n\n      if (nextData && currentTime >= nextData.timeStamp) {\n        setCurrentIndex(currentIndex + 1);\n      }\n\n      applyVideoAttributes(currentData);\n      drawVideoFrame();\n\n      animationRef.current = requestAnimationFrame(playback);\n    };\n\n    const applyVideoAttributes = (data) => {\n      if (!data) return;\n\n      videoRef.current.volume = data.volume;\n      videoRef.current.playbackRate = data.playbackRate;\n\n      const [x, y, width, height] = data.coordinates;\n      const cropperOverlay = cropperOverlayRef.current;\n      console.log('videoRef.current.getBoundingClientRect().height', videoRef.current.getBoundingClientRect().height, videoRef.current.getBoundingClientRect().width)\n      cropperOverlay.style.left = `${(x / videoRef.current.getBoundingClientRect().width) * 100}%`;\n      cropperOverlay.style.top = `${(y / videoRef.current.getBoundingClientRect().height) * 100}%`;\n      cropperOverlay.style.width = `${(width / videoRef.current.getBoundingClientRect().width) * 100}%`;\n      cropperOverlay.style.height = `${(height / videoRef.current.getBoundingClientRect().height) * 100}%`;\n    };\n\n    const drawVideoFrame = () => {\n      const fullVideoCanvas = fullVideoCanvasRef.current;\n      const fullVideoCtx = fullVideoCanvas.getContext('2d');\n\n      fullVideoCanvas.width = videoRef.current.videoWidth;\n      fullVideoCanvas.height = videoRef.current.videoHeight;\n\n      fullVideoCtx.drawImage(videoRef.current, 0, 0);\n    };\n\n    if (isPlaying) {\n      videoRef.current.play();\n      animationRef.current = requestAnimationFrame(playback);\n    } else {\n      videoRef.current.pause();\n      cancelAnimationFrame(animationRef.current);\n    }\n\n    return () => cancelAnimationFrame(animationRef.current);\n  }, [recordedData, currentIndex, isPlaying]);\n\n  const togglePlayback = () => {\n    setIsPlaying(!isPlaying);\n  };\n\n  return (\n    <div className='recorded-preview'>\n      <span className='cropper-bottom-btn' onClick={togglePlayback}>{isPlaying ? \"Pause Recording\" : \"Play Recording\"}</span>\n      <div className=\"video-container\">\n        <canvas\n          className=\"video\"\n          ref={fullVideoCanvasRef}\n        />\n        <div\n          id=\"draggable\"\n          ref={cropperOverlayRef}\n          className=\"cropper\"\n        >\n          <div class=\"grid-item\"></div>\n          <div class=\"grid-item\"></div>\n          <div class=\"grid-item\"></div>\n          <div class=\"grid-item\"></div>\n          <div class=\"grid-item\"></div>\n          <div class=\"grid-item\"></div>\n          <div class=\"grid-item\"></div>\n          <div class=\"grid-item\"></div>\n          <div class=\"grid-item\"></div>\n        </div>\n      </div>\n      <video ref={videoRef} src={videoSrc} style={{ visibility: \"hidden\" }} className=\"video-container-hidden\" />\n    </div>\n  );\n};\n\nexport default RecordedPreview;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}